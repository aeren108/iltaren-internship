import matplotlib.pyplot as plt
import numpy as np

plt.style.use('seaborn-whitegrid')

#toa = np.array([50, 100, 150, 350, 400, 550, 750, 800, 850, 950, 1050, 1080, 1090, 1100, 1200, 1600])
#toa = np.array([11, 15, 22, 30, 33, 41, 44, 45, 55, 60, 66, 75, 77, 88, 90, 99, 105, 108, 120, 131, 135, 150, 165, 168, 180, 220, 229, 290, 309, 390, 399, 450, 511, 572, 672, 733, 794, 856])
#toa = np.array([15, 20, 25, 45, 61, 75, 89, 100, 105, 133, 140, 155, 165, 182, 195, 220, 222, 223, 260, 285, 301, 350, 416, 480])

#toa = np.array([0, 5, 14, 25, 35, 46, 54, 69, 75, 88, 95, 115, 117, 132, 135, 137, 155, 175, 180, 195, 197, 211, 215, 225, 235, 261, 270, 299, 315, 322, 360, 389, 393, 405, 449,
#                453, 485, 495, 520, 577, 581, 645, 669, 709, 761, 853, 951, 1034])

#toa = np.array([15, 20, 25, 45, 60, 75, 92, 100, 105, 135, 140, 155, 165, 180, 195, 220, 220, 225, 253, 260, 284, 285, 300, 315, 340, 345, 350, 376, 380, 405, 415, 420, 435, 460, 465, 477, 495, 500, 525, 538, 545, 553, 579, 585, 610, 620, 660, 675, 700, 740, 740, 780, 805, 870, 935, 1000, 1065, 1130, 1190, 1260])
#toa = np.array([15, 20, 25, 45, 60, 75, 92, 100, 105, 135, 139, 155, 165, 180, 195, 220, 220, 225, 255, 257, 285, 285, 300, 315, 340, 345, 350, 375, 382, 405, 415, 420, 435, 460, 465, 480, 495, 500, 525, 539, 541, 555, 580, 585, 610, 615, 620, 645, 660, 675, 675, 700, 706, 735, 740, 740, 764, 780, 795, 808, 820, 825, 855, 860, 870, 885, 897, 935, 940, 980, 1000, 1020, 1059, 1065, 1097, 1130, 1140, 1178, 1195, 1260, 1325, 1393, 1452, 1520, 1585, 1650, 1715, 1780, 1845, 1912])
toa = np.array([15, 20, 25, 43, 60, 75, 90, 100, 105, 135, 140, 155, 165, 180, 195, 220, 220, 225, 255, 257, 285, 285, 300, 315, 340, 345, 350, 375, 380, 405, 415, 420, 435, 460, 465, 480, 495, 500, 525, 540, 548, 555, 580, 585, 610, 615, 620, 645, 660, 675, 675, 700, 705, 735, 737, 740, 765, 780, 795, 805, 820, 825, 855, 860, 870, 885, 900, 915, 933, 939, 945, 975, 980, 1000, 1005, 1021, 1035, 1057, 1065, 1066, 1093, 1100, 1125, 1130, 1140, 1155, 1180, 1185, 1197, 1215, 1220, 1245, 1260, 1260, 1275, 1300, 1305, 1325, 1335, 1340, 1365, 1380, 1390, 1395, 1420, 1425, 1455, 1457, 1460, 1485, 1500, 1515, 1520, 1540, 1545, 1575, 1580, 1585, 1605, 1618, 1633, 1653, 1660, 1665, 1694, 1700, 1715, 1726, 1740, 1755, 1780, 1780, 1783, 1815, 1820, 1845, 1845, 1860, 1875, 1900, 1905, 1907, 1935, 1940, 1966, 1976, 1980, 1995, 2020, 2025, 2040, 2053, 2062, 2085, 2100, 2105, 2115, 2140, 2145, 2170, 2175, 2180, 2205, 2217, 2233, 2235, 2259, 2265, 2295, 2300, 2300, 2325, 2337, 2355, 2365, 2380, 2385, 2415, 2420, 2433, 2445, 2462, 2475, 2495, 2500, 2505, 2535, 2540, 2560, 2565, 2580, 2595, 2618, 2625, 2625, 2656, 2660, 2685, 2690, 2698, 2715, 2740, 2745, 2755, 2775, 2780, 2804, 2820, 2820, 2835, 2860, 2865, 2885, 2895, 2897, 2925, 2938, 2950, 2955, 2979, 2985, 3015, 3015, 3020, 3044, 3060, 3075, 3084, 3100, 3105, 3135, 3140, 3145, 3165, 3179, 3194, 3210, 3220, 3225, 3255, 3260, 3270, 3285, 3300, 3313, 3340, 3340, 3345, 3375, 3377, 3405, 3407, 3421, 3435, 3460, 3465, 3470, 3495, 3500, 3525, 3537, 3538, 3555, 3577, 3585, 3601, 3615, 3620, 3645, 3660, 3665, 3675, 3700, 3705, 3730, 3735, 3740, 3765, 3780, 3795, 3795, 3818, 3825, 3855, 3860, 3860, 3885, 3902, 3915, 3925, 3937, 3945, 3976, 3980, 3990, 4005, 4020, 4035, 4055, 4060, 4065, 4095, 4100, 4120, 4125, 4138, 4155, 4180, 4185, 4185, 4215, 4220, 4245, 4250, 4260, 4275, 4300, 4305, 4315, 4335, 4340, 4364, 4375, 4382, 4395, 4422, 4425, 4445, 4456, 4460, 4485, 4500, 4510, 4515, 4540, 4545, 4575, 4575, 4580, 4605, 4620, 4635, 4640, 4660, 4665, 4695, 4700, 4703, 4725, 4740, 4754, 4772, 4780, 4785, 4815, 4820, 4835, 4845, 4860, 4875, 4900, 4900, 4906, 4935, 4940, 4965, 4966, 4980, 4995, 5022, 5025, 5025, 5053, 5060, 5085, 5090, 5098, 5113, 5140, 5145, 5160, 5175, 5180, 5205, 5220, 5223, 5235, 5260, 5265, 5290, 5295, 5301, 5326, 5340, 5355, 5359, 5380, 5385, 5415, 5420, 5420, 5445, 5458, 5475, 5485, 5500, 5505, 5535, 5540, 5550, 5564, 5580, 5595, 5615, 5621, 5625, 5653, 5660, 5675, 5685, 5700, 5715, 5740, 5745, 5745, 5773, 5780, 5805, 5810, 5820, 5835, 5857, 5865, 5875, 5895, 5899, 5925, 5940, 5940, 5956, 5980, 5985, 6007, 6016, 6020, 6043, 6060, 6070, 6075, 6100, 6105, 6135, 6135, 6140, 6164, 6180, 6195, 6200, 6220, 6225, 6253, 6260, 6267, 6285, 6301, 6315, 6330, 6339, 6345, 6375, 6380, 6395, 6405, 6417, 6435, 6460, 6460, 6465, 6494, 6497, 6525, 6526, 6540, 6555, 6580, 6585, 6590, 6615, 6619, 6645, 6655, 6660, 6675, 6700, 6705, 6721, 6735, 6740, 6765, 6782, 6785, 6795, 6820, 6825, 6850, 6853, 6860, 6885, 6900, 6914, 6915, 6940, 6946, 6975, 6976, 6980, 7005, 7020, 7035, 7045, 7060, 7063, 7093, 7100, 7110, 7123, 7140, 7155, 7175, 7180, 7185, 7215, 7220, 7240, 7245, 7260, 7273, 7300, 7305, 7305, 7336, 7340, 7365, 7370, 7380, 7395, 7420, 7425, 7432, 7455, 7460, 7485, 7500, 7501, 7515, 7540, 7545, 7563, 7575, 7580, 7605, 7620, 7633, 7635, 7660, 7665, 7695, 7700, 7737, 7760, 7782, 7820, 7825, 7860, 7890, 7900, 7940, 7956, 7980, 8020, 8020, 8060, 8085, 8099, 8140, 8150, 8182, 8215, 8220, 8257, 8280, 8300, 8340, 8345, 8382, 8410, 8420, 8460, 8474, 8500, 8540, 8540, 8580, 8605, 8621, 8660, 8670, 8700, 8735, 8740, 8782, 8803, 8818, 8860, 8865, 8900, 8925, 8940, 8980, 8995, 9020, 9060, 9060, 9100, 9125, 9140, 9180, 9190, 9220, 9255, 9260, 9300, 9320, 9340, 9380, 9388, 9420, 9450, 9460, 9500, 9515, 9540, 9580, 9580, 9620, 9640, 9660, 9700, 9710, 9740, 9775, 9780, 9820, 9840, 9860, 9900, 9905, 9940, 9970, 9980, 10020, 10035, 10060, 10100, 10100, 10140, 10165, 10180, 10220, 10230, 10295, 10360, 10425, 10490, 10555, 10620, 10685, 10750, 10815, 10883, 10945, 11010, 11075, 11140, 11205, 11270, 11335, 11400, 11465, 11530, 11595, 11660, 11725, 11790, 11856, 11920, 11985, 12050, 12115, 12183, 12245, 12310, 12375, 12440, 12505, 12570, 12635, 12700, 12760, 12830, 12895, 12960, 13025, 13090, 13155, 13220, 13285, 13350, 13415, 13480, 13545, 13605, 13675, 13740, 13805, 13870, 13935, 14000, 14065, 14130, 14195, 14260, 14321, 14392, 14455, 14520, 14589, 14650, 14715, 14780, 14845, 14910, 14975, 15040, 15105, 15170, 15235, 15300, 15365, 15430, 15495, 15560, 15625, 15690, 15755, 15820, 15885, 15950, 16015, 16080, 16145, 16208, 16275, 16340, 16405, 16472, 16535, 16600])
dtoa = np.diff(toa)

toa = toa - toa[0]

x = np.exp(1j*(2*np.pi/toa[-1])*toa)
X = np.fft.fft(x, n=x.size-1)
X = abs(X)

N = X.size
T = N
dw = 2*np.pi / T
df = 1 / T
w = np.array([dw*n if n<N/2 else dw*(n-N) for n in range(N)])
f = np.array([df*n if n<N/2 else df*(n-N) for n in range(N)])
argsorted = np.argsort(X)

print(1/w[argsorted[-1]])
print(1/w[argsorted[-3]])
print(1/w[argsorted[-4]])
print(1/w[argsorted[-6]])

#plt.plot(np.arange(len(toa)), toa, 'o', color="red")
#plt.plot(np.arange(len(dtoa)), dtoa, 'o', color="blue")
plt.plot(w, X, color="blue")

plt.show()

